


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="TSInterpret is a Python library for interpretable time series classification.">
      
      
      
        <meta name="author" content="Jacqueline HÃ¶llig">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-5.5.0">
    
    
      
        <title>Counterfactual - TSInterpret</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.b5d04df8.min.css">
      
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    
      
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#TSInterpret.InterpretabilityModels.counterfactual.CF" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../.." title="TSInterpret" class="md-header-nav__button md-logo" aria-label="TSInterpret">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            TSInterpret
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Counterfactual
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="TSInterpret" class="md-nav__button md-logo" aria-label="TSInterpret">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    TSInterpret
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../InterpretabilityMethods/" title="Interpretability" class="md-nav__link">
      Interpretability
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Usage
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Usage" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Usage
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-1" type="checkbox" id="nav-3-1">
    
    <label class="md-nav__link" for="nav-3-1">
      Instance-Based Methods
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Instance-Based Methods" data-md-level="2">
      <label class="md-nav__title" for="nav-3-1">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Instance-Based Methods
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-1-1" type="checkbox" id="nav-3-1-1">
    
    <label class="md-nav__link" for="nav-3-1-1">
      Counterfactuals
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Counterfactuals" data-md-level="3">
      <label class="md-nav__title" for="nav-3-1-1">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Counterfactuals
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Notebooks/Ates_torch/" title="Ates" class="md-nav__link">
      Ates
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Notebooks/NunCF_torch/" title="Nun-CF" class="md-nav__link">
      Nun-CF
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      Feature Attribution Methods
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Feature Attribution Methods" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Feature Attribution Methods
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Notebooks/Leftist_torch/" title="Leftist" class="md-nav__link">
      Leftist
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Notebooks/Ismail_torch/" title="Saliency" class="md-nav__link">
      Saliency
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      API References
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="API References" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        API References
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Model_Interface/" title="Models" class="md-nav__link">
      Models
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-2" type="checkbox" id="nav-4-2" checked>
    
    <label class="md-nav__link" for="nav-4-2">
      InterpretabilityMethods
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="InterpretabilityMethods" data-md-level="2">
      <label class="md-nav__title" for="nav-4-2">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        InterpretabilityMethods
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Counterfactual
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 9h14V7H3v2m0 4h14v-2H3v2m0 4h14v-2H3v2m16 0h2v-2h-2v2m0-10v2h2V7h-2m0 6h2v-2h-2v2z"/></svg>
        </span>
      </label>
    
    <a href="./" title="Counterfactual" class="md-nav__link md-nav__link--active">
      Counterfactual
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#TSInterpret.InterpretabilityModels.counterfactual.CF" class="md-nav__link">
    TSInterpret.InterpretabilityModels.counterfactual.CF
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#TSInterpret.InterpretabilityModels.counterfactual.CF.CF" class="md-nav__link">
    CF
  </a>
  
    <nav class="md-nav" aria-label="CF">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#TSInterpret.InterpretabilityModels.counterfactual.CF.CF.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#TSInterpret.InterpretabilityModels.counterfactual.CF.CF.explain" class="md-nav__link">
    explain()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#TSInterpret.InterpretabilityModels.counterfactual.CF.CF.plot" class="md-nav__link">
    plot()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#TSInterpret.InterpretabilityModels.counterfactual.CF.CF.plot_in_one" class="md-nav__link">
    plot_in_one()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#TSInterpret.InterpretabilityModels.counterfactual.CF.CF.plot_multi" class="md-nav__link">
    plot_multi()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#TSInterpret.InterpretabilityModels.counterfactual.NativeGuideCF" class="md-nav__link">
    TSInterpret.InterpretabilityModels.counterfactual.NativeGuideCF
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#TSInterpret.InterpretabilityModels.counterfactual.NativeGuideCF.NativeGuideCF" class="md-nav__link">
    NativeGuideCF
  </a>
  
    <nav class="md-nav" aria-label="NativeGuideCF">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#TSInterpret.InterpretabilityModels.counterfactual.NativeGuideCF.NativeGuideCF.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#TSInterpret.InterpretabilityModels.counterfactual.NativeGuideCF.NativeGuideCF.explain" class="md-nav__link">
    explain()
  </a>
  
    <nav class="md-nav" aria-label="explain()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#TSInterpret.InterpretabilityModels.counterfactual.NativeGuideCF.NativeGuideCF.explain--neighbors-to-select-from" class="md-nav__link">
    neighbors to select from.
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#TSInterpret.InterpretabilityModels.counterfactual.Ates" class="md-nav__link">
    TSInterpret.InterpretabilityModels.counterfactual.Ates
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#TSInterpret.InterpretabilityModels.counterfactual.Ates.AtesCF" class="md-nav__link">
    AtesCF
  </a>
  
    <nav class="md-nav" aria-label="AtesCF">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#TSInterpret.InterpretabilityModels.counterfactual.Ates.AtesCF.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#TSInterpret.InterpretabilityModels.counterfactual.Ates.AtesCF.explain" class="md-nav__link">
    explain()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Saliency/" title="Saliency" class="md-nav__link">
      Saliency
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Leftist/" title="LEFTIST" class="md-nav__link">
      LEFTIST
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#TSInterpret.InterpretabilityModels.counterfactual.CF" class="md-nav__link">
    TSInterpret.InterpretabilityModels.counterfactual.CF
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#TSInterpret.InterpretabilityModels.counterfactual.CF.CF" class="md-nav__link">
    CF
  </a>
  
    <nav class="md-nav" aria-label="CF">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#TSInterpret.InterpretabilityModels.counterfactual.CF.CF.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#TSInterpret.InterpretabilityModels.counterfactual.CF.CF.explain" class="md-nav__link">
    explain()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#TSInterpret.InterpretabilityModels.counterfactual.CF.CF.plot" class="md-nav__link">
    plot()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#TSInterpret.InterpretabilityModels.counterfactual.CF.CF.plot_in_one" class="md-nav__link">
    plot_in_one()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#TSInterpret.InterpretabilityModels.counterfactual.CF.CF.plot_multi" class="md-nav__link">
    plot_multi()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#TSInterpret.InterpretabilityModels.counterfactual.NativeGuideCF" class="md-nav__link">
    TSInterpret.InterpretabilityModels.counterfactual.NativeGuideCF
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#TSInterpret.InterpretabilityModels.counterfactual.NativeGuideCF.NativeGuideCF" class="md-nav__link">
    NativeGuideCF
  </a>
  
    <nav class="md-nav" aria-label="NativeGuideCF">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#TSInterpret.InterpretabilityModels.counterfactual.NativeGuideCF.NativeGuideCF.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#TSInterpret.InterpretabilityModels.counterfactual.NativeGuideCF.NativeGuideCF.explain" class="md-nav__link">
    explain()
  </a>
  
    <nav class="md-nav" aria-label="explain()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#TSInterpret.InterpretabilityModels.counterfactual.NativeGuideCF.NativeGuideCF.explain--neighbors-to-select-from" class="md-nav__link">
    neighbors to select from.
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#TSInterpret.InterpretabilityModels.counterfactual.Ates" class="md-nav__link">
    TSInterpret.InterpretabilityModels.counterfactual.Ates
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#TSInterpret.InterpretabilityModels.counterfactual.Ates.AtesCF" class="md-nav__link">
    AtesCF
  </a>
  
    <nav class="md-nav" aria-label="AtesCF">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#TSInterpret.InterpretabilityModels.counterfactual.Ates.AtesCF.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#TSInterpret.InterpretabilityModels.counterfactual.Ates.AtesCF.explain" class="md-nav__link">
    explain()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  
                
                
                  <h1>Counterfactual</h1>
                
                <div class="doc doc-object doc-module">

<a id="TSInterpret.InterpretabilityModels.counterfactual.CF"></a>
    <div class="doc doc-contents first">




  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="TSInterpret.InterpretabilityModels.counterfactual.CF.CF">
        <code>
CF            (<span title="TSInterpret.InterpretabilityModels.InstanceBase.InstanceBase">InstanceBase</span>)
        </code>



</h2>

    <div class="doc doc-contents ">

      <p>Abstract class to implement Coutnterfactual Methods for time series data </p>

        <details class="quote">
          <summary>Source code in <code>counterfactual/CF.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">CF</span><span class="p">(</span><span class="n">InstanceBase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Abstract class to implement Coutnterfactual Methods for time series data </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mlmodel</span><span class="p">,</span><span class="n">mode</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Initialization of CF. </span>
<span class="sd">        Arguments:</span>
<span class="sd">            model: Machine Learning Model to be explained.</span>
<span class="sd">            mode str : Second dimension is feature --&gt; &#39;feat&#39;, is time --&gt; &#39;time&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">mlmodel</span><span class="p">,</span><span class="n">mode</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">explain</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Explains instance or model. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Please don&#39;t use the base CF class directly&quot;</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">plot</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">original</span><span class="p">,</span><span class="n">org_label</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span><span class="n">exp_label</span><span class="p">,</span> <span class="n">vis_change</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span><span class="n">all_in_one</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">save_fig</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Basic Plot Function for visualizing Coutnerfactuals.</span>
<span class="sd">        Arguments:</span>
<span class="sd">            original np.array: Instance to be explained.</span>
<span class="sd">            org_label: Label of instance to be explained. </span>
<span class="sd">            exp np.array: Explanation.</span>
<span class="sd">            exp_label: Label of Explanation.</span>
<span class="sd">            vis_change bool: Change to be visualized as heatmap. </span>
<span class="sd">            all_in_one bool: Original and Counterfactual in one plot. </span>
<span class="sd">            save_fig str: Path to save fig at.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">all_in_one</span><span class="p">:</span>
            <span class="n">ax011</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">ax012</span> <span class="o">=</span> <span class="n">ax011</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
            <span class="n">sal_02</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">original</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">exp</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">vis_change</span><span class="p">:</span>
                <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">sal_02</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax011</span><span class="p">,</span> <span class="n">yticklabels</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span> 
                <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">sal_02</span><span class="p">),</span><span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax011</span><span class="p">,</span> <span class="n">yticklabels</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">original</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))),</span> <span class="n">y</span><span class="o">=</span><span class="n">original</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax012</span><span class="p">,</span><span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original&#39;</span><span class="p">)</span>
            <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">original</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))),</span> <span class="n">y</span><span class="o">=</span><span class="n">exp</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax012</span><span class="p">,</span><span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Counterfactual&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax011</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">ax012</span> <span class="o">=</span> <span class="n">ax011</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
            <span class="n">sal_02</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">original</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">exp</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">vis_change</span><span class="p">:</span>
                <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">sal_02</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax011</span><span class="p">,</span> <span class="n">yticklabels</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span> 
                <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">sal_02</span><span class="p">),</span><span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax011</span><span class="p">,</span> <span class="n">yticklabels</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

            <span class="n">p</span><span class="o">=</span><span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">original</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))),</span> <span class="n">y</span><span class="o">=</span><span class="n">original</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax012</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">org_label</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">p</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Original&quot;</span><span class="p">)</span>

            <span class="n">ax031</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">ax032</span> <span class="o">=</span> <span class="n">ax031</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
            <span class="n">sal_02</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">original</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">exp</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">vis_change</span><span class="p">:</span>
                <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">sal_02</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax031</span><span class="p">,</span> <span class="n">yticklabels</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span> 
                <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">sal_02</span><span class="p">),</span><span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax011</span><span class="p">,</span> <span class="n">yticklabels</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

            <span class="n">p</span><span class="o">=</span><span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">original</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))),</span> <span class="n">y</span><span class="o">=</span><span class="n">exp</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax032</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">exp_label</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">p</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Counterfactual&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">save_fig</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span> 
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">save_fig</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">plot_in_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">item</span><span class="p">,</span><span class="n">org_label</span><span class="p">,</span><span class="n">exp</span><span class="p">,</span><span class="n">cf_label</span><span class="p">,</span> <span class="n">save_fig</span><span class="o">=</span> <span class="kc">None</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">)):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot Function for Counterfactuals in uni-and multivariate setting. In the multivariate setting only the changed features are visualized.</span>
<span class="sd">        Arguments:</span>
<span class="sd">            item np.array: original instance.</span>
<span class="sd">            org_label int: originally predicted label. </span>
<span class="sd">            exp np.array: returned explanation. </span>
<span class="sd">            cf_label int: lebel of returned instance. </span>
<span class="sd">            figsize Tuple: Size of Figure (x,y).</span>
<span class="sd">            save_fig str: Path to Save the figure.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;time&#39;</span><span class="p">:</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">item</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">item</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> 
        <span class="c1">#TODO This is new and needs to be testes</span>
        <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="p">(</span><span class="n">item</span> <span class="o">!=</span> <span class="n">exp</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">ind</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ind</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Items are identical&#39;</span><span class="p">)</span>
                <span class="k">return</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">ind</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_multi</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="n">org_label</span><span class="p">,</span><span class="n">exp</span><span class="p">,</span><span class="n">cf_label</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">save_fig</span><span class="o">=</span><span class="n">save_fig</span><span class="p">)</span>
                <span class="k">return</span>
            <span class="k">else</span><span class="p">:</span> 
                <span class="n">item</span> <span class="o">=</span><span class="n">item</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;classic&quot;</span><span class="p">)</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;#08F7FE&#39;</span><span class="p">,</span>  <span class="c1"># teal/cyan</span>
            <span class="s1">&#39;#FE53BB&#39;</span><span class="p">,</span>  <span class="c1"># pink</span>
            <span class="s1">&#39;#F5D300&#39;</span><span class="p">,</span>  <span class="c1"># yellow</span>
            <span class="s1">&#39;#00ff41&#39;</span><span class="p">,</span>  <span class="c1"># matrix green</span>
        <span class="p">]</span>
        <span class="n">indices</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">exp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">item</span><span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="sa">f</span><span class="s1">&#39;Predicted: </span><span class="si">{</span><span class="n">org_label</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">flatten</span><span class="p">()),</span>
                   <span class="sa">f</span><span class="s1">&#39;Counterfactual: </span><span class="si">{</span><span class="n">cf_label</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">exp</span><span class="o">.</span><span class="n">flatten</span><span class="p">())})</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
        <span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
        <span class="c1"># Redraw the data with low alpha and slighty increased linewidth:</span>
        <span class="n">n_shades</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="n">diff_linewidth</span> <span class="o">=</span> <span class="mf">1.05</span>
        <span class="n">alpha_value</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="o">/</span> <span class="n">n_shades</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_shades</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">diff_linewidth</span><span class="o">*</span><span class="n">n</span><span class="p">),</span>
            <span class="n">alpha</span><span class="o">=</span><span class="n">alpha_value</span><span class="p">,</span>
            <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;#2A3459&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="n">fontweight</span> <span class="o">=</span> <span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;large&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Value&#39;</span><span class="p">,</span> <span class="n">fontweight</span> <span class="o">=</span> <span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;large&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">save_fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> 
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">save_fig</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">plot_multi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">item</span><span class="p">,</span><span class="n">org_label</span><span class="p">,</span><span class="n">exp</span><span class="p">,</span><span class="n">cf_label</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">),</span> <span class="n">save_fig</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot Function for Ates et al., used if multiple features are changed in a Multivariate Setting. Also called via plot_in_one. Preferably, do not use directly.</span>
<span class="sd">        Arguments:</span>
<span class="sd">            item np.array: original instance.</span>
<span class="sd">            org_label int: originally predicted label. </span>
<span class="sd">            exp np.array: returned explanation. </span>
<span class="sd">            cf_label int: lebel of returned instance. </span>
<span class="sd">            figsize Tuple: Size of Figure (x,y).</span>
<span class="sd">            save_fig str: Path to Save the figure.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#if self.mode == &#39;time&#39;:</span>
        <span class="c1">#    item = item.reshape(item.shape[0],item.shape[2],item.shape[1]) </span>

        <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;classic&quot;</span><span class="p">)</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;#08F7FE&#39;</span><span class="p">,</span>  <span class="c1"># teal/cyan</span>
            <span class="s1">&#39;#FE53BB&#39;</span><span class="p">,</span>  <span class="c1"># pink</span>
            <span class="s1">&#39;#F5D300&#39;</span><span class="p">,</span>  <span class="c1"># yellow</span>
            <span class="s1">&#39;#00ff41&#39;</span><span class="p">,</span>  <span class="c1"># matrix green</span>
        <span class="p">]</span>
        <span class="c1">#Figure out number changed channels</span>
        <span class="c1">#index= np.where(np.any(item))</span>

        <span class="n">i</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">res</span> <span class="o">=</span> <span class="p">(</span><span class="n">item</span> <span class="o">!=</span> <span class="n">exp</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ind</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ind</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Items are identical&#39;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="c1">#Draw changed channels</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ind</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>

        <span class="c1">#print(ax)</span>
        <span class="k">for</span> <span class="n">channel</span> <span class="ow">in</span> <span class="n">ind</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="c1">#fig,ax=plt.subplot(len(ind[0]),1,i)</span>

            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="sa">f</span><span class="s1">&#39;Predicted: </span><span class="si">{</span><span class="n">org_label</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">channel</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()),</span>
                   <span class="sa">f</span><span class="s1">&#39;Counterfactual: </span><span class="si">{</span><span class="n">cf_label</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">exp</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">channel</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">())})</span>

            <span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="c1"># Redraw the data with low alpha and slighty increased linewidth:</span>
            <span class="n">n_shades</span> <span class="o">=</span> <span class="mi">10</span>
            <span class="n">diff_linewidth</span> <span class="o">=</span> <span class="mf">1.05</span>
            <span class="n">alpha_value</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="o">/</span> <span class="n">n_shades</span>
            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_shades</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span>
                <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">diff_linewidth</span><span class="o">*</span><span class="n">n</span><span class="p">),</span>
                <span class="n">alpha</span><span class="o">=</span><span class="n">alpha_value</span><span class="p">,</span>
                <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">)</span>

            <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;#2A3459&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="n">fontweight</span> <span class="o">=</span> <span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;large&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Value&#39;</span><span class="p">,</span> <span class="n">fontweight</span> <span class="o">=</span> <span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;large&#39;</span><span class="p">)</span>
            <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span>
        <span class="k">if</span> <span class="n">save_fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> 
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">save_fig</span><span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="TSInterpret.InterpretabilityModels.counterfactual.CF.CF.__init__">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mlmodel</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Initialization of CF. </p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>model</code></td>
        <td></td>
        <td><p>Machine Learning Model to be explained.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>mode</code></td>
        <td><code>str </code></td>
        <td><p>Second dimension is feature --&gt; 'feat', is time --&gt; 'time'</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>counterfactual/CF.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mlmodel</span><span class="p">,</span><span class="n">mode</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Initialization of CF. </span>
<span class="sd">    Arguments:</span>
<span class="sd">        model: Machine Learning Model to be explained.</span>
<span class="sd">        mode str : Second dimension is feature --&gt; &#39;feat&#39;, is time --&gt; &#39;time&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">mlmodel</span><span class="p">,</span><span class="n">mode</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="TSInterpret.InterpretabilityModels.counterfactual.CF.CF.explain">
<code class="highlight language-python"><span class="n">explain</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Explains instance or model. </p>

        <details class="quote">
          <summary>Source code in <code>counterfactual/CF.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">explain</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Explains instance or model. </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Please don&#39;t use the base CF class directly&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="TSInterpret.InterpretabilityModels.counterfactual.CF.CF.plot">
<code class="highlight language-python"><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">original</span><span class="p">,</span> <span class="n">org_label</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">exp_label</span><span class="p">,</span> <span class="n">vis_change</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">all_in_one</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">save_fig</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Basic Plot Function for visualizing Coutnerfactuals.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>original</code></td>
        <td><code>np.array</code></td>
        <td><p>Instance to be explained.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>org_label</code></td>
        <td></td>
        <td><p>Label of instance to be explained. </p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>exp</code></td>
        <td><code>np.array</code></td>
        <td><p>Explanation.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>exp_label</code></td>
        <td></td>
        <td><p>Label of Explanation.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>vis_change</code></td>
        <td><code>bool</code></td>
        <td><p>Change to be visualized as heatmap. </p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>all_in_one</code></td>
        <td><code>bool</code></td>
        <td><p>Original and Counterfactual in one plot. </p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>save_fig</code></td>
        <td><code>str</code></td>
        <td><p>Path to save fig at.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>counterfactual/CF.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">plot</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">original</span><span class="p">,</span><span class="n">org_label</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span><span class="n">exp_label</span><span class="p">,</span> <span class="n">vis_change</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span><span class="n">all_in_one</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">save_fig</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Basic Plot Function for visualizing Coutnerfactuals.</span>
<span class="sd">    Arguments:</span>
<span class="sd">        original np.array: Instance to be explained.</span>
<span class="sd">        org_label: Label of instance to be explained. </span>
<span class="sd">        exp np.array: Explanation.</span>
<span class="sd">        exp_label: Label of Explanation.</span>
<span class="sd">        vis_change bool: Change to be visualized as heatmap. </span>
<span class="sd">        all_in_one bool: Original and Counterfactual in one plot. </span>
<span class="sd">        save_fig str: Path to save fig at.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">all_in_one</span><span class="p">:</span>
        <span class="n">ax011</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ax012</span> <span class="o">=</span> <span class="n">ax011</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
        <span class="n">sal_02</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">original</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">exp</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">vis_change</span><span class="p">:</span>
            <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">sal_02</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax011</span><span class="p">,</span> <span class="n">yticklabels</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">sal_02</span><span class="p">),</span><span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax011</span><span class="p">,</span> <span class="n">yticklabels</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">original</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))),</span> <span class="n">y</span><span class="o">=</span><span class="n">original</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax012</span><span class="p">,</span><span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original&#39;</span><span class="p">)</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">original</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))),</span> <span class="n">y</span><span class="o">=</span><span class="n">exp</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax012</span><span class="p">,</span><span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Counterfactual&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax011</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ax012</span> <span class="o">=</span> <span class="n">ax011</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
        <span class="n">sal_02</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">original</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">exp</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">vis_change</span><span class="p">:</span>
            <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">sal_02</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax011</span><span class="p">,</span> <span class="n">yticklabels</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">sal_02</span><span class="p">),</span><span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax011</span><span class="p">,</span> <span class="n">yticklabels</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">p</span><span class="o">=</span><span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">original</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))),</span> <span class="n">y</span><span class="o">=</span><span class="n">original</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax012</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">org_label</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Original&quot;</span><span class="p">)</span>

        <span class="n">ax031</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">ax032</span> <span class="o">=</span> <span class="n">ax031</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
        <span class="n">sal_02</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">original</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">exp</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">vis_change</span><span class="p">:</span>
            <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">sal_02</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax031</span><span class="p">,</span> <span class="n">yticklabels</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">sal_02</span><span class="p">),</span><span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax011</span><span class="p">,</span> <span class="n">yticklabels</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">p</span><span class="o">=</span><span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">original</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))),</span> <span class="n">y</span><span class="o">=</span><span class="n">exp</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax032</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">exp_label</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Counterfactual&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">save_fig</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span> 
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">save_fig</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="TSInterpret.InterpretabilityModels.counterfactual.CF.CF.plot_in_one">
<code class="highlight language-python"><span class="n">plot_in_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">org_label</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">cf_label</span><span class="p">,</span> <span class="n">save_fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Plot Function for Counterfactuals in uni-and multivariate setting. In the multivariate setting only the changed features are visualized.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>item</code></td>
        <td><code>np.array</code></td>
        <td><p>original instance.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>org_label</code></td>
        <td><code>int</code></td>
        <td><p>originally predicted label. </p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>exp</code></td>
        <td><code>np.array</code></td>
        <td><p>returned explanation. </p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>cf_label</code></td>
        <td><code>int</code></td>
        <td><p>lebel of returned instance. </p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>figsize</code></td>
        <td><code>Tuple</code></td>
        <td><p>Size of Figure (x,y).</p></td>
        <td><code>(15, 15)</code></td>
      </tr>
      <tr>
        <td><code>save_fig</code></td>
        <td><code>str</code></td>
        <td><p>Path to Save the figure.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>counterfactual/CF.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">plot_in_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">item</span><span class="p">,</span><span class="n">org_label</span><span class="p">,</span><span class="n">exp</span><span class="p">,</span><span class="n">cf_label</span><span class="p">,</span> <span class="n">save_fig</span><span class="o">=</span> <span class="kc">None</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">)):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot Function for Counterfactuals in uni-and multivariate setting. In the multivariate setting only the changed features are visualized.</span>
<span class="sd">    Arguments:</span>
<span class="sd">        item np.array: original instance.</span>
<span class="sd">        org_label int: originally predicted label. </span>
<span class="sd">        exp np.array: returned explanation. </span>
<span class="sd">        cf_label int: lebel of returned instance. </span>
<span class="sd">        figsize Tuple: Size of Figure (x,y).</span>
<span class="sd">        save_fig str: Path to Save the figure.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;time&#39;</span><span class="p">:</span>
        <span class="n">item</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">item</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">item</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> 
    <span class="c1">#TODO This is new and needs to be testes</span>
    <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="p">(</span><span class="n">item</span> <span class="o">!=</span> <span class="n">exp</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ind</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ind</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Items are identical&#39;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">ind</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_multi</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="n">org_label</span><span class="p">,</span><span class="n">exp</span><span class="p">,</span><span class="n">cf_label</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">save_fig</span><span class="o">=</span><span class="n">save_fig</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="n">item</span> <span class="o">=</span><span class="n">item</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;classic&quot;</span><span class="p">)</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;#08F7FE&#39;</span><span class="p">,</span>  <span class="c1"># teal/cyan</span>
        <span class="s1">&#39;#FE53BB&#39;</span><span class="p">,</span>  <span class="c1"># pink</span>
        <span class="s1">&#39;#F5D300&#39;</span><span class="p">,</span>  <span class="c1"># yellow</span>
        <span class="s1">&#39;#00ff41&#39;</span><span class="p">,</span>  <span class="c1"># matrix green</span>
    <span class="p">]</span>
    <span class="n">indices</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">exp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">item</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="sa">f</span><span class="s1">&#39;Predicted: </span><span class="si">{</span><span class="n">org_label</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">flatten</span><span class="p">()),</span>
               <span class="sa">f</span><span class="s1">&#39;Counterfactual: </span><span class="si">{</span><span class="n">cf_label</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">exp</span><span class="o">.</span><span class="n">flatten</span><span class="p">())})</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
    <span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="c1"># Redraw the data with low alpha and slighty increased linewidth:</span>
    <span class="n">n_shades</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">diff_linewidth</span> <span class="o">=</span> <span class="mf">1.05</span>
    <span class="n">alpha_value</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="o">/</span> <span class="n">n_shades</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_shades</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">diff_linewidth</span><span class="o">*</span><span class="n">n</span><span class="p">),</span>
        <span class="n">alpha</span><span class="o">=</span><span class="n">alpha_value</span><span class="p">,</span>
        <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;#2A3459&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="n">fontweight</span> <span class="o">=</span> <span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;large&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Value&#39;</span><span class="p">,</span> <span class="n">fontweight</span> <span class="o">=</span> <span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;large&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">save_fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> 
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">save_fig</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="TSInterpret.InterpretabilityModels.counterfactual.CF.CF.plot_multi">
<code class="highlight language-python"><span class="n">plot_multi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">org_label</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">cf_label</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="n">save_fig</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Plot Function for Ates et al., used if multiple features are changed in a Multivariate Setting. Also called via plot_in_one. Preferably, do not use directly.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>item</code></td>
        <td><code>np.array</code></td>
        <td><p>original instance.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>org_label</code></td>
        <td><code>int</code></td>
        <td><p>originally predicted label. </p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>exp</code></td>
        <td><code>np.array</code></td>
        <td><p>returned explanation. </p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>cf_label</code></td>
        <td><code>int</code></td>
        <td><p>lebel of returned instance. </p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>figsize</code></td>
        <td><code>Tuple</code></td>
        <td><p>Size of Figure (x,y).</p></td>
        <td><code>(15, 15)</code></td>
      </tr>
      <tr>
        <td><code>save_fig</code></td>
        <td><code>str</code></td>
        <td><p>Path to Save the figure.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>counterfactual/CF.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">plot_multi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">item</span><span class="p">,</span><span class="n">org_label</span><span class="p">,</span><span class="n">exp</span><span class="p">,</span><span class="n">cf_label</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">),</span> <span class="n">save_fig</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Plot Function for Ates et al., used if multiple features are changed in a Multivariate Setting. Also called via plot_in_one. Preferably, do not use directly.</span>
<span class="sd">    Arguments:</span>
<span class="sd">        item np.array: original instance.</span>
<span class="sd">        org_label int: originally predicted label. </span>
<span class="sd">        exp np.array: returned explanation. </span>
<span class="sd">        cf_label int: lebel of returned instance. </span>
<span class="sd">        figsize Tuple: Size of Figure (x,y).</span>
<span class="sd">        save_fig str: Path to Save the figure.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#if self.mode == &#39;time&#39;:</span>
    <span class="c1">#    item = item.reshape(item.shape[0],item.shape[2],item.shape[1]) </span>

    <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;classic&quot;</span><span class="p">)</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;#08F7FE&#39;</span><span class="p">,</span>  <span class="c1"># teal/cyan</span>
        <span class="s1">&#39;#FE53BB&#39;</span><span class="p">,</span>  <span class="c1"># pink</span>
        <span class="s1">&#39;#F5D300&#39;</span><span class="p">,</span>  <span class="c1"># yellow</span>
        <span class="s1">&#39;#00ff41&#39;</span><span class="p">,</span>  <span class="c1"># matrix green</span>
    <span class="p">]</span>
    <span class="c1">#Figure out number changed channels</span>
    <span class="c1">#index= np.where(np.any(item))</span>

    <span class="n">i</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">res</span> <span class="o">=</span> <span class="p">(</span><span class="n">item</span> <span class="o">!=</span> <span class="n">exp</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ind</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ind</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Items are identical&#39;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="c1">#Draw changed channels</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ind</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>

    <span class="c1">#print(ax)</span>
    <span class="k">for</span> <span class="n">channel</span> <span class="ow">in</span> <span class="n">ind</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="c1">#fig,ax=plt.subplot(len(ind[0]),1,i)</span>

        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="sa">f</span><span class="s1">&#39;Predicted: </span><span class="si">{</span><span class="n">org_label</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">channel</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()),</span>
               <span class="sa">f</span><span class="s1">&#39;Counterfactual: </span><span class="si">{</span><span class="n">cf_label</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">exp</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">channel</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">())})</span>

        <span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="c1"># Redraw the data with low alpha and slighty increased linewidth:</span>
        <span class="n">n_shades</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="n">diff_linewidth</span> <span class="o">=</span> <span class="mf">1.05</span>
        <span class="n">alpha_value</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="o">/</span> <span class="n">n_shades</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_shades</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">diff_linewidth</span><span class="o">*</span><span class="n">n</span><span class="p">),</span>
            <span class="n">alpha</span><span class="o">=</span><span class="n">alpha_value</span><span class="p">,</span>
            <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
            <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">)</span>

        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;#2A3459&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="n">fontweight</span> <span class="o">=</span> <span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;large&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Value&#39;</span><span class="p">,</span> <span class="n">fontweight</span> <span class="o">=</span> <span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;large&#39;</span><span class="p">)</span>
        <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span>
    <span class="k">if</span> <span class="n">save_fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> 
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">save_fig</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">

<a id="TSInterpret.InterpretabilityModels.counterfactual.NativeGuideCF"></a>
    <div class="doc doc-contents first">

      <p>Implementation after Delaney et al . https://github.com/e-delaney/Instance-Based_CFE_TSC</p>



  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="TSInterpret.InterpretabilityModels.counterfactual.NativeGuideCF.NativeGuideCF">
        <code>
NativeGuideCF            (<a class="autorefs autorefs-internal" title="TSInterpret.InterpretabilityModels.counterfactual.CF.CF" href="#TSInterpret.InterpretabilityModels.counterfactual.CF.CF">CF</a>)
        </code>



</h2>

    <div class="doc doc-contents ">

      <p>NUN_CF according to [1] for both torch and tensorflow. 
[1] Delaney, E., Greene, D., Keane, M.T.: Instance-Based Counterfactual Explanations
    for Time Series Classification. In: Sanchez-Ruiz, A.A., Floyd, M.W. (eds.) Case-
    Based Reasoning Research and Development, vol. 12877, pp. 32â47. Springer
    International Publishing, Cham (2021), series Title: Lecture Notes in Computer
    Science. </p>

        <details class="quote">
          <summary>Source code in <code>counterfactual/NativeGuideCF.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">NativeGuideCF</span><span class="p">(</span><span class="n">CF</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    NUN_CF according to [1] for both torch and tensorflow. </span>
<span class="sd">    [1] Delaney, E., Greene, D., Keane, M.T.: Instance-Based Counterfactual Explanations</span>
<span class="sd">        for Time Series Classification. In: Sanchez-Ruiz, A.A., Floyd, M.W. (eds.) Case-</span>
<span class="sd">        Based Reasoning Research and Development, vol. 12877, pp. 32â47. Springer</span>
<span class="sd">        International Publishing, Cham (2021), series Title: Lecture Notes in Computer</span>
<span class="sd">        Science. </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span><span class="n">shape</span><span class="p">,</span> <span class="n">reference_set</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="s1">&#39;torch&#39;</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span><span class="s1">&#39;feat&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        In this case differentiation between time &amp; feat not necessary as implicitly given by CNN. Only works for CNNs due to the attribution methods.</span>
<span class="sd">        Arguments:</span>
<span class="sd">            model: classification model to explain</span>
<span class="sd">            shape Tuple: input shape</span>
<span class="sd">            reference set Tuple: reference set as tuple (x,y)</span>
<span class="sd">            backend str: &#39;PYT&#39; or  &#39;TF&#39;</span>
<span class="sd">            mode str: model either &#39;time&#39; or &#39;feat&#39;</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">mode</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="o">=</span><span class="n">backend</span>
        <span class="n">test_x</span><span class="p">,</span><span class="n">test_y</span><span class="o">=</span><span class="n">reference_set</span>
        <span class="n">test_x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">test_x</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;time&#39;</span><span class="p">:</span>
            <span class="c1">#Parse test data into (1, feat, time):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ts_length</span><span class="o">=</span> <span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">test_x</span><span class="o">=</span><span class="n">test_x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">test_x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">test_x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">test_x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;feat&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ts_length</span><span class="o">=</span> <span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">backend</span> <span class="o">==</span> <span class="s1">&#39;PYT&#39;</span><span class="p">:</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cam_extractor</span> <span class="o">=</span><span class="n">CAM</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span><span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;GradCam Hook already registered&#39;</span><span class="p">)</span>
            <span class="n">change</span><span class="o">=</span><span class="kc">False</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span><span class="s1">&#39;time&#39;</span><span class="p">:</span>
                <span class="n">change</span><span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="o">=</span><span class="n">PyTorchModel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span><span class="n">change</span><span class="p">)</span><span class="o">.</span><span class="n">predict</span>
            <span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_x</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">backend</span><span class="o">==</span> <span class="s1">&#39;TF&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cam_extractor</span> <span class="o">=</span><span class="n">GradCam1D</span><span class="p">()</span> <span class="c1">#VanillaGradients()#GradCam1D()</span>
            <span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ts_length</span><span class="p">,</span><span class="mi">1</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="o">=</span><span class="n">TensorFlowModel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span><span class="n">change</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">predict</span>            
        <span class="k">else</span><span class="p">:</span> 
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Only Compatible with Tensorflow (TF) or Pytorch (PYT)!&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">reference_set</span><span class="o">=</span><span class="p">(</span><span class="n">test_x</span><span class="p">,</span><span class="n">y_pred</span><span class="p">)</span>
        <span class="c1">#Manipulate reference set replace original y with predicted y </span>

    <span class="k">def</span> <span class="nf">_native_guide_retrieval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">query</span><span class="p">,</span> <span class="n">predicted_label</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">n_neighbors</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        This gets the nearest unlike neighbors.</span>
<span class="sd">        Arguments:</span>
<span class="sd">            query (np.array): The instance to explain.</span>
<span class="sd">            predicted_label (np.array): Label of instance.</span>
<span class="sd">            reference_set (np.array): Set of addtional labeled data (could be training or test set)</span>
<span class="sd">            distance (str): </span>
<span class="sd">            num_neighbors (int):number nearest neighbors to return</span>
<span class="sd">        Returns:</span>
<span class="sd">            [np.array]: Returns K_Nearest_Neighbors of input query with different classification label.</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">predicted_label</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">int</span><span class="p">:</span>
            <span class="n">predicted_label</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">predicted_label</span><span class="p">)</span>

        <span class="n">x_train</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">reference_set</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
            <span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ts_length</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ts_length</span>
        <span class="n">knn</span> <span class="o">=</span> <span class="n">KNeighborsTimeSeries</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="n">n_neighbors</span><span class="p">,</span> <span class="n">metric</span> <span class="o">=</span> <span class="n">distance</span><span class="p">)</span>
        <span class="n">knn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">y</span> <span class="o">!=</span> <span class="n">predicted_label</span><span class="p">))]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ts_length</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">dist</span><span class="p">,</span><span class="n">ind</span> <span class="o">=</span> <span class="n">knn</span><span class="o">.</span><span class="n">kneighbors</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ts_length</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">return_distance</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">x_train</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ts_length</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">dist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">x_train</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">y</span> <span class="o">!=</span> <span class="n">predicted_label</span><span class="p">)][</span><span class="n">ind</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>

    <span class="k">def</span> <span class="nf">_native_guide_wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">query</span><span class="p">,</span> <span class="n">predicted_label</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">n_neighbors</span><span class="p">):</span>
        <span class="n">_</span><span class="p">,</span><span class="n">nun</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_native_guide_retrieval</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">predicted_label</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">n_neighbors</span><span class="p">)</span>
        <span class="n">individual</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">nun</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
        <span class="n">out</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">individual</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">nun</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_findSubarray</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span> <span class="c1">#used to find the maximum contigious subarray of length k in the explanation weight vector</span>

        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

        <span class="n">vec</span><span class="o">=</span><span class="p">[]</span> 

        <span class="c1"># Iterate to find all the sub-arrays </span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span> 
            <span class="n">temp</span><span class="o">=</span><span class="p">[]</span> 

            <span class="c1"># Store the sub-array elements in the array </span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="n">k</span><span class="p">):</span> 
                <span class="n">temp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> 

            <span class="c1"># Push the vector in the container </span>
            <span class="n">vec</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span> 

        <span class="n">sum_arr</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vec</span><span class="p">:</span>
            <span class="n">sum_arr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">vec</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">sum_arr</span><span class="p">)])</span>

    <span class="k">def</span> <span class="nf">_counterfactual_generator_swap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">instance</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span><span class="n">subarray_length</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">500</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
        <span class="n">_</span><span class="p">,</span><span class="n">nun</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_native_guide_retrieval</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="s1">&#39;euclidean&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="n">nun</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">instance</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Starting and nun are Identical !&#39;</span><span class="p">)</span>

        <span class="n">test_x</span><span class="p">,</span><span class="n">test_y</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">reference_set</span>
        <span class="n">train_x</span><span class="o">=</span><span class="n">test_x</span>
        <span class="n">individual</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">nun</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
        <span class="n">out</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">individual</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="o">==</span><span class="s1">&#39;PYT&#39;</span><span class="p">:</span> 
            <span class="n">training_weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cam_extractor</span><span class="p">(</span><span class="n">out</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">argmax</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span> <span class="n">out</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="o">==</span><span class="s1">&#39;TF&#39;</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">training_weights</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cam_extractor</span><span class="o">.</span><span class="n">explain</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span><span class="n">class_index</span><span class="o">=</span><span class="n">label</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="c1"># grad_cam(self.model, instance.reshape(1,-1,1))#self.cam_extractor.explain(data, self.model,class_index=label)#instance</span>
        <span class="c1">#Classify Original</span>
        <span class="n">individual</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
        <span class="n">out</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">individual</span><span class="p">)</span>


        <span class="n">most_influencial_array</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_findSubarray</span><span class="p">((</span><span class="n">training_weights</span><span class="p">),</span> <span class="n">subarray_length</span><span class="p">)</span>

        <span class="n">starting_point</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">training_weights</span><span class="o">==</span><span class="n">most_influencial_array</span><span class="p">[</span><span class="mi">0</span><span class="p">])[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">X_example</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">nun</span><span class="o">=</span><span class="n">nun</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">X_example</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">starting_point</span><span class="p">:</span><span class="n">subarray_length</span><span class="o">+</span><span class="n">starting_point</span><span class="p">]</span> <span class="o">=</span><span class="n">nun</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">starting_point</span><span class="p">:</span><span class="n">subarray_length</span><span class="o">+</span><span class="n">starting_point</span><span class="p">]</span>
        <span class="n">individual</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X_example</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">train_x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
        <span class="n">out</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">individual</span><span class="p">)</span>
        <span class="n">prob_target</span> <span class="o">=</span>  <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">label</span><span class="p">]</span> <span class="c1">#torch.nn.functional.softmax(model(torch.from_numpy(test_x))).detach().numpy()[0][y_pred[instance]]</span>
        <span class="n">counter</span><span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">prob_target</span> <span class="o">&gt;</span> <span class="mf">0.5</span> <span class="ow">and</span> <span class="n">counter</span> <span class="o">&lt;</span><span class="n">max_iter</span><span class="p">:</span>

            <span class="n">subarray_length</span> <span class="o">+=</span><span class="mi">1</span>        
            <span class="n">most_influencial_array</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_findSubarray</span><span class="p">((</span><span class="n">training_weights</span><span class="p">),</span> <span class="n">subarray_length</span><span class="p">)</span>
            <span class="n">starting_point</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">training_weights</span><span class="o">==</span><span class="n">most_influencial_array</span><span class="p">[</span><span class="mi">0</span><span class="p">])[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">X_example</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">X_example</span><span class="p">[:,</span><span class="n">starting_point</span><span class="p">:</span><span class="n">subarray_length</span><span class="o">+</span><span class="n">starting_point</span><span class="p">]</span> <span class="o">=</span><span class="n">nun</span><span class="p">[:,</span><span class="n">starting_point</span><span class="p">:</span><span class="n">subarray_length</span><span class="o">+</span><span class="n">starting_point</span><span class="p">]</span>
            <span class="n">individual</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X_example</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">train_x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
            <span class="n">out</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">individual</span><span class="p">)</span>
            <span class="n">prob_target</span> <span class="o">=</span> <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">label</span><span class="p">]</span>
            <span class="n">counter</span><span class="o">=</span><span class="n">counter</span><span class="o">+</span><span class="mi">1</span>
            <span class="k">if</span> <span class="n">counter</span><span class="o">==</span><span class="n">max_iter</span> <span class="ow">or</span> <span class="n">subarray_length</span><span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">ts_length</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No Counterfactual found&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="n">X_example</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_instance_based_cf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">query</span><span class="p">,</span><span class="n">label</span><span class="p">,</span><span class="n">target</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">distance</span><span class="o">=</span><span class="s1">&#39;dtw&#39;</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">500</span><span class="p">):</span>

        <span class="n">d</span><span class="p">,</span><span class="n">nan</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_native_guide_retrieval</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">beta</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">insample_cf</span> <span class="o">=</span> <span class="n">nan</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">individual</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>

        <span class="n">output</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">individual</span><span class="p">)</span>
        <span class="n">pred_treshold</span> <span class="o">=</span> <span class="mf">0.5</span>
        <span class="n">target</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">output</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> 
        <span class="n">query</span><span class="o">=</span><span class="n">query</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">insample_cf</span><span class="o">=</span><span class="n">insample_cf</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">generated_cf</span> <span class="o">=</span> <span class="n">dtw_barycenter_averaging</span><span class="p">([</span><span class="n">query</span><span class="p">,</span> <span class="n">insample_cf</span><span class="p">],</span> <span class="n">weights</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="mi">1</span><span class="o">-</span><span class="n">beta</span><span class="p">),</span> <span class="n">beta</span><span class="p">]))</span>
        <span class="n">generated_cf</span> <span class="o">=</span> <span class="n">generated_cf</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">individual</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">generated_cf</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
        <span class="n">prob_target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">individual</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="n">target</span><span class="p">]</span>
        <span class="n">counter</span><span class="o">=</span><span class="mi">0</span>

        <span class="k">while</span> <span class="n">prob_target</span> <span class="o">&lt;</span> <span class="n">pred_treshold</span> <span class="ow">and</span> <span class="n">counter</span><span class="o">&lt;</span><span class="n">max_iter</span><span class="p">:</span>
            <span class="n">beta</span> <span class="o">+=</span><span class="mf">0.01</span> 
            <span class="n">generated_cf</span><span class="o">=</span> <span class="n">dtw_barycenter_averaging</span><span class="p">([</span><span class="n">query</span><span class="p">,</span> <span class="n">insample_cf</span><span class="p">],</span> <span class="n">weights</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="mi">1</span><span class="o">-</span><span class="n">beta</span><span class="p">),</span> <span class="n">beta</span><span class="p">]))</span>
            <span class="n">generated_cf</span> <span class="o">=</span> <span class="n">generated_cf</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">individual</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">generated_cf</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
            <span class="n">prob_target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">individual</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="n">target</span><span class="p">]</span>

            <span class="n">counter</span><span class="o">=</span><span class="n">counter</span><span class="o">+</span><span class="mi">1</span>
        <span class="k">if</span> <span class="n">counter</span><span class="o">==</span><span class="n">max_iter</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No Counterfactual found&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="n">generated_cf</span><span class="p">,</span> <span class="n">target</span>

    <span class="k">def</span> <span class="nf">explain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>  <span class="n">y</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;NUN_CF&#39;</span><span class="p">,</span> <span class="n">distance_measure</span><span class="o">=</span><span class="s1">&#39;dtw&#39;</span><span class="p">,</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span><span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
        <span class="sd">&#39;&#39;&#39;&#39;</span>
<span class="sd">        Explains a specific instance x.</span>
<span class="sd">        Arguments:</span>
<span class="sd">            x np.array : instance to be explained.</span>
<span class="sd">            y int: predicted label for instance x. </span>
<span class="sd">            method str: &#39;Nun_CF&#39;, &#39;dtw_bary_center&#39; or &#39;native_guide&#39;.</span>
<span class="sd">            distance_measure str: sklearn appreviation for distance of knn.</span>
<span class="sd">            n_neighbore int: # neighbors to select from.</span>
<span class="sd">            max_iter int : max number of runs</span>
<span class="sd">        Returns:</span>
<span class="sd">            Tuple: (counterfactual, counterfactual label)</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span><span class="s1">&#39;time&#39;</span><span class="p">:</span>
            <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">method</span><span class="o">==</span><span class="s1">&#39;NG&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_native_guide_wrapper</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">distance_measure</span><span class="p">,</span> <span class="n">n_neighbors</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">method</span><span class="o">==</span><span class="s1">&#39;dtw_bary_center&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_instance_based_cf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">distance_measure</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">method</span><span class="o">==</span><span class="s1">&#39;NUN_CF&#39;</span><span class="p">:</span>
            <span class="n">distance_measure</span><span class="o">=</span><span class="s1">&#39;euclidean&#39;</span>
            <span class="k">return</span>  <span class="bp">self</span><span class="o">.</span><span class="n">_counterfactual_generator_swap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span><span class="n">max_iter</span><span class="o">=</span><span class="n">max_iter</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Unknown Method selected.&#39;</span><span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="TSInterpret.InterpretabilityModels.counterfactual.NativeGuideCF.NativeGuideCF.__init__">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">reference_set</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="s1">&#39;torch&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;feat&#39;</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>In this case differentiation between time &amp; feat not necessary as implicitly given by CNN. Only works for CNNs due to the attribution methods.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>model</code></td>
        <td></td>
        <td><p>classification model to explain</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>shape</code></td>
        <td><code>Tuple</code></td>
        <td><p>input shape</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>reference</code></td>
        <td><code>set Tuple</code></td>
        <td><p>reference set as tuple (x,y)</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>backend</code></td>
        <td><code>str</code></td>
        <td><p>'PYT' or  'TF'</p></td>
        <td><code>&#39;torch&#39;</code></td>
      </tr>
      <tr>
        <td><code>mode</code></td>
        <td><code>str</code></td>
        <td><p>model either 'time' or 'feat'</p></td>
        <td><code>&#39;feat&#39;</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>counterfactual/NativeGuideCF.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span><span class="n">shape</span><span class="p">,</span> <span class="n">reference_set</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="s1">&#39;torch&#39;</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span><span class="s1">&#39;feat&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    In this case differentiation between time &amp; feat not necessary as implicitly given by CNN. Only works for CNNs due to the attribution methods.</span>
<span class="sd">    Arguments:</span>
<span class="sd">        model: classification model to explain</span>
<span class="sd">        shape Tuple: input shape</span>
<span class="sd">        reference set Tuple: reference set as tuple (x,y)</span>
<span class="sd">        backend str: &#39;PYT&#39; or  &#39;TF&#39;</span>
<span class="sd">        mode str: model either &#39;time&#39; or &#39;feat&#39;</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">mode</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="o">=</span><span class="n">backend</span>
    <span class="n">test_x</span><span class="p">,</span><span class="n">test_y</span><span class="o">=</span><span class="n">reference_set</span>
    <span class="n">test_x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">test_x</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;time&#39;</span><span class="p">:</span>
        <span class="c1">#Parse test data into (1, feat, time):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ts_length</span><span class="o">=</span> <span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">test_x</span><span class="o">=</span><span class="n">test_x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">test_x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">test_x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">test_x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;feat&#39;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ts_length</span><span class="o">=</span> <span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">backend</span> <span class="o">==</span> <span class="s1">&#39;PYT&#39;</span><span class="p">:</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cam_extractor</span> <span class="o">=</span><span class="n">CAM</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span><span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;GradCam Hook already registered&#39;</span><span class="p">)</span>
        <span class="n">change</span><span class="o">=</span><span class="kc">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span><span class="s1">&#39;time&#39;</span><span class="p">:</span>
            <span class="n">change</span><span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="o">=</span><span class="n">PyTorchModel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span><span class="n">change</span><span class="p">)</span><span class="o">.</span><span class="n">predict</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_x</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">backend</span><span class="o">==</span> <span class="s1">&#39;TF&#39;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cam_extractor</span> <span class="o">=</span><span class="n">GradCam1D</span><span class="p">()</span> <span class="c1">#VanillaGradients()#GradCam1D()</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ts_length</span><span class="p">,</span><span class="mi">1</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="o">=</span><span class="n">TensorFlowModel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span><span class="n">change</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">predict</span>            
    <span class="k">else</span><span class="p">:</span> 
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Only Compatible with Tensorflow (TF) or Pytorch (PYT)!&#39;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">reference_set</span><span class="o">=</span><span class="p">(</span><span class="n">test_x</span><span class="p">,</span><span class="n">y_pred</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="TSInterpret.InterpretabilityModels.counterfactual.NativeGuideCF.NativeGuideCF.explain">
<code class="highlight language-python"><span class="n">explain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;NUN_CF&#39;</span><span class="p">,</span> <span class="n">distance_measure</span><span class="o">=</span><span class="s1">&#39;dtw&#39;</span><span class="p">,</span> <span class="n">n_neighbors</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>'
Explains a specific instance x.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>x</code></td>
        <td><code>np.array </code></td>
        <td><p>instance to be explained.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>y</code></td>
        <td><code>int</code></td>
        <td><p>predicted label for instance x. </p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>method</code></td>
        <td><code>str</code></td>
        <td><p>'Nun_CF', 'dtw_bary_center' or 'native_guide'.</p></td>
        <td><code>&#39;NUN_CF&#39;</code></td>
      </tr>
      <tr>
        <td><code>distance_measure</code></td>
        <td><code>str</code></td>
        <td><p>sklearn appreviation for distance of knn.</p></td>
        <td><code>&#39;dtw&#39;</code></td>
      </tr>
      <tr>
        <td><code>n_neighbore</code></td>
        <td><code>int</code></td>
        <td><h4 id="TSInterpret.InterpretabilityModels.counterfactual.NativeGuideCF.NativeGuideCF.explain--neighbors-to-select-from">neighbors to select from.</h4></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>max_iter</code></td>
        <td><code>int </code></td>
        <td><p>max number of runs</p></td>
        <td><code>500</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Tuple</code></td>
      <td><p>(counterfactual, counterfactual label)</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>counterfactual/NativeGuideCF.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">explain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>  <span class="n">y</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;NUN_CF&#39;</span><span class="p">,</span> <span class="n">distance_measure</span><span class="o">=</span><span class="s1">&#39;dtw&#39;</span><span class="p">,</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span><span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
    <span class="sd">&#39;&#39;&#39;&#39;</span>
<span class="sd">    Explains a specific instance x.</span>
<span class="sd">    Arguments:</span>
<span class="sd">        x np.array : instance to be explained.</span>
<span class="sd">        y int: predicted label for instance x. </span>
<span class="sd">        method str: &#39;Nun_CF&#39;, &#39;dtw_bary_center&#39; or &#39;native_guide&#39;.</span>
<span class="sd">        distance_measure str: sklearn appreviation for distance of knn.</span>
<span class="sd">        n_neighbore int: # neighbors to select from.</span>
<span class="sd">        max_iter int : max number of runs</span>
<span class="sd">    Returns:</span>
<span class="sd">        Tuple: (counterfactual, counterfactual label)</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span><span class="s1">&#39;time&#39;</span><span class="p">:</span>
        <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">method</span><span class="o">==</span><span class="s1">&#39;NG&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_native_guide_wrapper</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">distance_measure</span><span class="p">,</span> <span class="n">n_neighbors</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">method</span><span class="o">==</span><span class="s1">&#39;dtw_bary_center&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_instance_based_cf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">distance_measure</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">method</span><span class="o">==</span><span class="s1">&#39;NUN_CF&#39;</span><span class="p">:</span>
        <span class="n">distance_measure</span><span class="o">=</span><span class="s1">&#39;euclidean&#39;</span>
        <span class="k">return</span>  <span class="bp">self</span><span class="o">.</span><span class="n">_counterfactual_generator_swap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span><span class="n">max_iter</span><span class="o">=</span><span class="n">max_iter</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Unknown Method selected.&#39;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">

<a id="TSInterpret.InterpretabilityModels.counterfactual.Ates"></a>
    <div class="doc doc-contents first">

      <p>Contains the code for ICAPAI'21 paper "Counterfactual Explanations for Multivariate Time Series"
!!! authors
    Emre Ates (1), Burak Aksar (1), Vitus J. Leung (2), Ayse K. Coskun (1)
!!! affiliations
    (1) Department of Electrical and Computer Engineering, Boston University
    (2) Sandia National Laboratories
This work has been partially funded by Sandia National Laboratories. Sandia
National Laboratories is a multimission laboratory managed and operated by
National Technology and Engineering Solutions of Sandia, LLC., a wholly owned
subsidiary of Honeywell International, Inc., for the U.S. Department of
Energyâs National Nuclear Security Administration under Contract DENA0003525.</p>



  <div class="doc doc-children">










  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="TSInterpret.InterpretabilityModels.counterfactual.Ates.AtesCF">
        <code>
AtesCF            (<a class="autorefs autorefs-internal" title="TSInterpret.InterpretabilityModels.counterfactual.CF.CF" href="#TSInterpret.InterpretabilityModels.counterfactual.CF.CF">CF</a>)
        </code>



</h2>

    <div class="doc doc-contents ">

      <p>Calculates and Visualizes Counterfactuals for Multivariate Time Series in accordance to the paper [@ates_counterfactual_2021].</p>
<p>[1] Ates, Emre, et al. "Counterfactual Explanations for Multivariate Time Series." 2021 International Conference on Applied Artificial Intelligence (ICAPAI). IEEE, 2021.</p>

        <details class="quote">
          <summary>Source code in <code>counterfactual/Ates.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">AtesCF</span><span class="p">(</span><span class="n">CF</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculates and Visualizes Counterfactuals for Multivariate Time Series in accordance to the paper [@ates_counterfactual_2021].</span>

<span class="sd">     [1] Ates, Emre, et al. &quot;Counterfactual Explanations for Multivariate Time Series.&quot; 2021 International Conference on Applied Artificial Intelligence (ICAPAI). IEEE, 2021.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">model</span><span class="p">,</span> <span class="n">ref</span><span class="p">,</span> <span class="n">backend</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span> <span class="s1">&#39;opt&#39;</span><span class="p">,</span> <span class="n">number_distractors</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">max_attempts</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">silent</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Arguments:</span>
<span class="sd">            model : Model to be interpreted.</span>
<span class="sd">            ref Tuple: Reference Dataset as Tuple (x,y).</span>
<span class="sd">            backend: desired Model Backend (&#39;PYT&#39;, &#39;TF&#39;, &#39;SK&#39;).</span>
<span class="sd">            mode: Name of second dimension: time -&gt; (-1, time, feature) or feat -&gt; (-1, feature, time)</span>
<span class="sd">            method str : &#39;opt&#39; if optimized calculation, &#39;brute&#39; for Brute Force</span>
<span class="sd">            number_distractors int: number of distractore to be used</span>
<span class="sd">            silent bool: logging.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">mode</span><span class="p">)</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="o">=</span><span class="n">backend</span>
        <span class="n">test_x</span><span class="p">,</span><span class="n">test_y</span><span class="o">=</span><span class="n">ref</span>
        <span class="n">shape</span><span class="o">=</span><span class="n">test_x</span><span class="o">.</span><span class="n">shape</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;time&#39;</span><span class="p">:</span>
            <span class="c1">#Parse test data into (1, feat, time):</span>
            <span class="n">change</span><span class="o">=</span><span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ts_length</span><span class="o">=</span> <span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">test_x</span><span class="o">=</span><span class="n">test_x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">test_x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">test_x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">test_x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;feat&#39;</span><span class="p">:</span>
            <span class="n">change</span><span class="o">=</span><span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ts_length</span><span class="o">=</span> <span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">backend</span><span class="o">==</span><span class="s1">&#39;PYT&#39;</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="o">=</span><span class="n">PyTorchModel</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">change</span><span class="p">)</span><span class="o">.</span><span class="n">predict</span>
        <span class="k">elif</span> <span class="n">backend</span> <span class="o">==</span> <span class="s1">&#39;TF&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="o">=</span><span class="n">TensorFlowModel</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">change</span><span class="p">)</span><span class="o">.</span><span class="n">predict</span>

        <span class="k">elif</span> <span class="n">backend</span> <span class="o">==</span> <span class="s1">&#39;SK&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="o">=</span><span class="n">SklearnModel</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">change</span><span class="p">)</span><span class="o">.</span><span class="n">predict</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">referenceset</span><span class="o">=</span><span class="p">(</span><span class="n">test_x</span><span class="p">,</span><span class="n">test_y</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="o">=</span><span class="n">method</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">silent</span><span class="o">=</span><span class="n">silent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">number_distractors</span><span class="o">=</span><span class="n">number_distractors</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">max_attemps</span><span class="o">=</span> <span class="n">max_attempts</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_iter</span><span class="o">=</span><span class="n">max_iter</span>


    <span class="k">def</span> <span class="nf">explain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span><span class="n">orig_class</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span><span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Calculates the Counterfactual according to Ates.</span>
<span class="sd">        Arguments:</span>
<span class="sd">            x (np.array): The instance to explain.</span>
<span class="sd">            target (np.array): target class. If no target class is given, the class with the secon heighest classification probability is selected.</span>

<span class="sd">        Returns:</span>
<span class="sd">            ([np.array], int): Tuple of Counterfactual and Label</span>

<span class="sd">        &#39;&#39;&#39;</span>        

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">!=</span> <span class="s1">&#39;feat&#39;</span><span class="p">:</span>
            <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">train_x</span><span class="p">,</span><span class="n">train_y</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">referenceset</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
             <span class="n">train_y</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">train_y</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="o">==</span><span class="s1">&#39;opt&#39;</span><span class="p">:</span>
            <span class="n">opt</span><span class="o">=</span><span class="n">OptimizedSearch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">,</span> <span class="n">train_x</span><span class="p">,</span> <span class="n">train_y</span><span class="p">,</span> <span class="n">silent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">silent</span><span class="p">,</span> <span class="n">threads</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">num_distractors</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">number_distractors</span><span class="p">,</span> <span class="n">max_attempts</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_attemps</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_iter</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">opt</span><span class="o">.</span><span class="n">explain</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">to_maximize</span><span class="o">=</span><span class="n">target</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span><span class="s1">&#39;brute&#39;</span><span class="p">:</span>
            <span class="c1">#TODO Currently not Threadable as TF Model does not support</span>
            <span class="n">opt</span><span class="o">=</span><span class="n">BruteForceSearch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">,</span> <span class="n">train_x</span><span class="p">,</span><span class="n">train_y</span><span class="p">,</span> <span class="n">threads</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">opt</span><span class="o">.</span><span class="n">explain</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">to_maximize</span><span class="o">=</span><span class="n">target</span><span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="TSInterpret.InterpretabilityModels.counterfactual.Ates.AtesCF.__init__">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">ref</span><span class="p">,</span> <span class="n">backend</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;opt&#39;</span><span class="p">,</span> <span class="n">number_distractors</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">max_attempts</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">silent</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">


<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>model</code></td>
        <td></td>
        <td><p>Model to be interpreted.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>ref</code></td>
        <td><code>Tuple</code></td>
        <td><p>Reference Dataset as Tuple (x,y).</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>backend</code></td>
        <td></td>
        <td><p>desired Model Backend ('PYT', 'TF', 'SK').</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>mode</code></td>
        <td></td>
        <td><p>Name of second dimension: time -&gt; (-1, time, feature) or feat -&gt; (-1, feature, time)</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>method</code></td>
        <td><code>str </code></td>
        <td><p>'opt' if optimized calculation, 'brute' for Brute Force</p></td>
        <td><code>&#39;opt&#39;</code></td>
      </tr>
      <tr>
        <td><code>number_distractors</code></td>
        <td><code>int</code></td>
        <td><p>number of distractore to be used</p></td>
        <td><code>2</code></td>
      </tr>
      <tr>
        <td><code>silent</code></td>
        <td><code>bool</code></td>
        <td><p>logging.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>counterfactual/Ates.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">model</span><span class="p">,</span> <span class="n">ref</span><span class="p">,</span> <span class="n">backend</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span> <span class="s1">&#39;opt&#39;</span><span class="p">,</span> <span class="n">number_distractors</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">max_attempts</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">silent</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Arguments:</span>
<span class="sd">        model : Model to be interpreted.</span>
<span class="sd">        ref Tuple: Reference Dataset as Tuple (x,y).</span>
<span class="sd">        backend: desired Model Backend (&#39;PYT&#39;, &#39;TF&#39;, &#39;SK&#39;).</span>
<span class="sd">        mode: Name of second dimension: time -&gt; (-1, time, feature) or feat -&gt; (-1, feature, time)</span>
<span class="sd">        method str : &#39;opt&#39; if optimized calculation, &#39;brute&#39; for Brute Force</span>
<span class="sd">        number_distractors int: number of distractore to be used</span>
<span class="sd">        silent bool: logging.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">mode</span><span class="p">)</span> 
    <span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="o">=</span><span class="n">backend</span>
    <span class="n">test_x</span><span class="p">,</span><span class="n">test_y</span><span class="o">=</span><span class="n">ref</span>
    <span class="n">shape</span><span class="o">=</span><span class="n">test_x</span><span class="o">.</span><span class="n">shape</span>
    <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;time&#39;</span><span class="p">:</span>
        <span class="c1">#Parse test data into (1, feat, time):</span>
        <span class="n">change</span><span class="o">=</span><span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ts_length</span><span class="o">=</span> <span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">test_x</span><span class="o">=</span><span class="n">test_x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">test_x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">test_x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">test_x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;feat&#39;</span><span class="p">:</span>
        <span class="n">change</span><span class="o">=</span><span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ts_length</span><span class="o">=</span> <span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">backend</span><span class="o">==</span><span class="s1">&#39;PYT&#39;</span><span class="p">:</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="o">=</span><span class="n">PyTorchModel</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">change</span><span class="p">)</span><span class="o">.</span><span class="n">predict</span>
    <span class="k">elif</span> <span class="n">backend</span> <span class="o">==</span> <span class="s1">&#39;TF&#39;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="o">=</span><span class="n">TensorFlowModel</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">change</span><span class="p">)</span><span class="o">.</span><span class="n">predict</span>

    <span class="k">elif</span> <span class="n">backend</span> <span class="o">==</span> <span class="s1">&#39;SK&#39;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="o">=</span><span class="n">SklearnModel</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">change</span><span class="p">)</span><span class="o">.</span><span class="n">predict</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">referenceset</span><span class="o">=</span><span class="p">(</span><span class="n">test_x</span><span class="p">,</span><span class="n">test_y</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="o">=</span><span class="n">method</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">silent</span><span class="o">=</span><span class="n">silent</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">number_distractors</span><span class="o">=</span><span class="n">number_distractors</span> 
    <span class="bp">self</span><span class="o">.</span><span class="n">max_attemps</span><span class="o">=</span> <span class="n">max_attempts</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">max_iter</span><span class="o">=</span><span class="n">max_iter</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="TSInterpret.InterpretabilityModels.counterfactual.Ates.AtesCF.explain">
<code class="highlight language-python"><span class="n">explain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">orig_class</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Calculates the Counterfactual according to Ates.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>x</code></td>
        <td><code>np.array</code></td>
        <td><p>The instance to explain.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>target</code></td>
        <td><code>np.array</code></td>
        <td><p>target class. If no target class is given, the class with the secon heighest classification probability is selected.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>([np.array], int)</code></td>
      <td><p>Tuple of Counterfactual and Label</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>counterfactual/Ates.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">explain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span><span class="n">orig_class</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span><span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculates the Counterfactual according to Ates.</span>
<span class="sd">    Arguments:</span>
<span class="sd">        x (np.array): The instance to explain.</span>
<span class="sd">        target (np.array): target class. If no target class is given, the class with the secon heighest classification probability is selected.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ([np.array], int): Tuple of Counterfactual and Label</span>

<span class="sd">    &#39;&#39;&#39;</span>        

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">!=</span> <span class="s1">&#39;feat&#39;</span><span class="p">:</span>
        <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">train_x</span><span class="p">,</span><span class="n">train_y</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">referenceset</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
         <span class="n">train_y</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">train_y</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="o">==</span><span class="s1">&#39;opt&#39;</span><span class="p">:</span>
        <span class="n">opt</span><span class="o">=</span><span class="n">OptimizedSearch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">,</span> <span class="n">train_x</span><span class="p">,</span> <span class="n">train_y</span><span class="p">,</span> <span class="n">silent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">silent</span><span class="p">,</span> <span class="n">threads</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">num_distractors</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">number_distractors</span><span class="p">,</span> <span class="n">max_attempts</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_attemps</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_iter</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">opt</span><span class="o">.</span><span class="n">explain</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">to_maximize</span><span class="o">=</span><span class="n">target</span><span class="p">)</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span><span class="s1">&#39;brute&#39;</span><span class="p">:</span>
        <span class="c1">#TODO Currently not Threadable as TF Model does not support</span>
        <span class="n">opt</span><span class="o">=</span><span class="n">BruteForceSearch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">,</span> <span class="n">train_x</span><span class="p">,</span><span class="n">train_y</span><span class="p">,</span> <span class="n">threads</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">opt</span><span class="o">.</span><span class="n">explain</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">to_maximize</span><span class="o">=</span><span class="n">target</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>











  </div>

    </div>

  </div>

<p>\bibliography</p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../../Model_Interface/" title="Models" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Models
              </div>
            </div>
          </a>
        
        
          <a href="../Saliency/" title="Saliency" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Saliency
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.92ffa368.min.js"></script>
      <script src="../../assets/javascripts/bundle.5123e3d4.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.a68abb33.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>